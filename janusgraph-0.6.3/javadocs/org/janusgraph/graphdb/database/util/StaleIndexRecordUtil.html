<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_322) on Mon Nov 21 23:20:10 IST 2022 -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>StaleIndexRecordUtil (JanusGraph-Core: Core Library for JanusGraph 0.6.3-SNAPSHOT API)</title>
<meta name="date" content="2022-11-21">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="StaleIndexRecordUtil (JanusGraph-Core: Core Library for JanusGraph 0.6.3-SNAPSHOT API)";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":9,"i1":9,"i2":9,"i3":9,"i4":9};
var tabs = {65535:["t0","All Methods"],1:["t1","Static Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/StaleIndexRecordUtil.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../org/janusgraph/graphdb/database/util/IndexRecordUtil.html" title="class in org.janusgraph.graphdb.database.util"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li>Next&nbsp;Class</li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?org/janusgraph/graphdb/database/util/StaleIndexRecordUtil.html" target="_top">Frames</a></li>
<li><a href="StaleIndexRecordUtil.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.janusgraph.graphdb.database.util</div>
<h2 title="Class StaleIndexRecordUtil" class="title">Class StaleIndexRecordUtil</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">java.lang.Object</a></li>
<li>
<ul class="inheritance">
<li>org.janusgraph.graphdb.database.util.StaleIndexRecordUtil</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public class <span class="typeNameLabel">StaleIndexRecordUtil</span>
extends <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></pre>
<div class="block">Helper class which simplifies stale index modification operations.
 This class should normally be never used because it may cause index corruption problems in case it is used incorrectly.
 <p>
 In case more complicated index record modifications are needed, for example a case when a stale index have missing
 added elements to the graph then it's possible to manually add or remove any index records of the index.
 To do so you will need to use `BackendTransaction` directly.
 Below is an example of direct `BackendTransaction` usage.
 <p>
 Vertex index record update:
 <pre>
 StandardJanusGraph graph = (StandardJanusGraph) JanusGraphFactory.open(configuration);
 StandardJanusGraphTx tx = (StandardJanusGraphTx) graph.newTransaction();
 ManagementSystem mgmt = (ManagementSystem) graph.openManagement();
 // Let's say we want to remove non-existent vertex from a stale index.
 // We will assume the next constraints:
 // vertex id is 12345;
 // Composite index name is: nameIndex
 // There is a single indexed property: name
 // Value of the vertex property is: HelloWorld
 long vertexId = 12345L;
 String compositeIndexName = "nameIndex";
 String propertyKeyName = "name";
 String value = "HelloWorld";
 PropertyKey propertyKey = mgmt.getPropertyKey(propertyKeyName);
 long propertyKeyId = propertyKey.longId();
 IndexRecordEntry namePropertyIndexRecord = new IndexRecordEntry(propertyKeyId, value, propertyKey);
 IndexRecordEntry[] fullIndexRecord = new IndexRecordEntry[]{namePropertyIndexRecord};
 JanusGraphElement elementToBeRemoved = new CacheVertex(tx, vertexId, ElementLifeCycle.New);
 JanusGraphIndex indexToBeUpdated = managementSystem.getGraphIndex(compositeIndexName);
 JanusGraphSchemaVertex indexSchemaVertex = managementSystem.getSchemaVertex(indexToBeUpdated);
 CompositeIndexType compositeIndexTypeToBeUpdated = (CompositeIndexType) indexSchemaVertex.asIndexType();
 Serializer serializer = graph.getDataSerializer();
 boolean hashKeys = graph.getIndexSerializer().isHashKeys();
 HashingUtil.HashLength hashLength = graph.getIndexSerializer().getHashLength();
 IndexUpdate<StaticBuffer, Entry> update = IndexRecordUtil.getCompositeIndexUpdate(
     compositeIndexTypeToBeUpdated,
     IndexMutationType.DELETE,
     fullIndexRecord,
     elementToBeRemoved,
     serializer,
     hashKeys,
     hashLength
 );
 BackendTransaction backendTransaction = tx.getTxHandle();
 backendTransaction.mutateIndex(update.getKey(), Collections.emptyList(), Collections.singletonList(update.getEntry()));
 transaction.commit();
 tx.commit();
 mgmt.rollback();
 </pre>

 In case above you wanted to add index entry instead of removing it you would need to use <a href="../../../../../org/janusgraph/graphdb/database/index/IndexMutationType.html#ADD"><code>IndexMutationType.ADD</code></a> instead
 of <a href="../../../../../org/janusgraph/graphdb/database/index/IndexMutationType.html#DELETE"><code>IndexMutationType.DELETE</code></a> as provide entries collection as a second parameter into
 <a href="../../../../../org/janusgraph/diskstorage/BackendTransaction.html#mutateIndex-org.janusgraph.diskstorage.StaticBuffer-java.util.List-java.util.List-"><code>mutateIndex</code></a> method instead of third parameter.
 I.e. <code>backendTransaction.mutateIndex(update.getKey(), Collections.emptyList(), Collections.singletonList(update.getEntry()));</code>

 <p>
 Edge index record update is currently more limited to Vertex index record update above as you will need to find `relationId`
 as well as both ids of the connected vertices. It may be more challenging in case you don't have those elements in the graph.
 Thus, below example shows how to remove index record of *existing* edge which leads to stale index. You shouldn't repeat
 below steps unless you want to force remove existing edge index record.
 <pre>
 StandardJanusGraph graph = (StandardJanusGraph) JanusGraphFactory.open(configuration);
 StandardJanusGraphTx tx = (StandardJanusGraphTx) graph.newTransaction();
 ManagementSystem mgmt = (ManagementSystem) graph.openManagement();
 // Let's say we want to remove existent edge from an index.
 // We will assume the next constraints:
 // Composite index name is: nameIndex
 // There is a single indexed property: name
 // Value of the vertex property is: HelloWorld
 String compositeIndexName = "nameIndex";
 String propertyKeyName = "name";
 String value = "HelloWorld";
 PropertyKey propertyKey = mgmt.getPropertyKey(propertyKeyName);
 Edge edge = tx.traversal().E().has(propertyKeyName, value).next();
 RelationIdentifier relationIdentifier = (RelationIdentifier) edge.id();
 long relationId = relationIdentifier.getRelationId();
 EdgeLabel edgeLabel = managementSystem.getEdgeLabel(edgeName);
 IndexRecordEntry[] fullIndexRecord = new IndexRecordEntry[]{new IndexRecordEntry(relationId, value, propertyKey)};
 InternalVertex internalVertex1 = (InternalVertex) edge.outVertex();
 InternalVertex internalVertex2 = (InternalVertex) edge.inVertex();
 JanusGraphElement elementToBeRemoved = new StandardEdge(relationId, edgeLabel, internalVertex1, internalVertex2, ElementLifeCycle.New);
 JanusGraphIndex indexToBeUpdated = managementSystem.getGraphIndex(compositeIndexName);
 JanusGraphSchemaVertex indexSchemaVertex = managementSystem.getSchemaVertex(indexToBeUpdated);
 CompositeIndexType compositeIndexTypeToBeUpdated = (CompositeIndexType) indexSchemaVertex.asIndexType();
 Serializer serializer = graph.getDataSerializer();
 boolean hashKeys = graph.getIndexSerializer().isHashKeys();
 HashingUtil.HashLength hashLength = graph.getIndexSerializer().getHashLength();
 IndexUpdate<StaticBuffer, Entry> update = IndexRecordUtil.getCompositeIndexUpdate(
     compositeIndexTypeToBeUpdated,
     IndexMutationType.DELETE,
     fullIndexRecord,
     elementToBeRemoved,
     serializer,
     hashKeys,
     hashLength
 );
 BackendTransaction backendTransaction = tx.getTxHandle();
 backendTransaction.mutateIndex(update.getKey(), Collections.emptyList(), Collections.singletonList(update.getEntry()));
 transaction.commit();
 tx.commit();
 mgmt.rollback();
 </pre></div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../../org/janusgraph/graphdb/database/util/StaleIndexRecordUtil.html#StaleIndexRecordUtil--">StaleIndexRecordUtil</a></span>()</code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t1" class="tableTab"><span><a href="javascript:show(1);">Static Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>static void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/janusgraph/graphdb/database/util/StaleIndexRecordUtil.html#forceRemoveElementFromGraphIndex-org.janusgraph.core.JanusGraphElement-org.janusgraph.graphdb.database.IndexRecordEntry:A-org.janusgraph.graphdb.database.StandardJanusGraph-java.lang.String-">forceRemoveElementFromGraphIndex</a></span>(<a href="../../../../../org/janusgraph/core/JanusGraphElement.html" title="interface in org.janusgraph.core">JanusGraphElement</a>&nbsp;elementToRemoveFromIndex,
                                <a href="../../../../../org/janusgraph/graphdb/database/IndexRecordEntry.html" title="class in org.janusgraph.graphdb.database">IndexRecordEntry</a>[]&nbsp;indexRecord,
                                <a href="../../../../../org/janusgraph/graphdb/database/StandardJanusGraph.html" title="class in org.janusgraph.graphdb.database">StandardJanusGraph</a>&nbsp;graph,
                                <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;graphIndexName)</code>
<div class="block">Force removes element record from a graph index.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>static void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/janusgraph/graphdb/database/util/StaleIndexRecordUtil.html#forceRemoveElementFromMixedIndex-java.lang.Object-org.janusgraph.graphdb.database.IndexRecordEntry:A-org.janusgraph.core.JanusGraph-java.lang.String-">forceRemoveElementFromMixedIndex</a></span>(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a>&nbsp;elementId,
                                <a href="../../../../../org/janusgraph/graphdb/database/IndexRecordEntry.html" title="class in org.janusgraph.graphdb.database">IndexRecordEntry</a>[]&nbsp;indexRecord,
                                <a href="../../../../../org/janusgraph/core/JanusGraph.html" title="interface in org.janusgraph.core">JanusGraph</a>&nbsp;graph,
                                <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;mixedIndexName)</code>
<div class="block">Force removes element record from a mixed index.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>static void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/janusgraph/graphdb/database/util/StaleIndexRecordUtil.html#forceRemoveElementFromMixedIndex-java.lang.Object-org.janusgraph.core.JanusGraph-java.lang.String-">forceRemoveElementFromMixedIndex</a></span>(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a>&nbsp;elementId,
                                <a href="../../../../../org/janusgraph/core/JanusGraph.html" title="interface in org.janusgraph.core">JanusGraph</a>&nbsp;graph,
                                <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;mixedIndexName)</code>
<div class="block">Force removes element fully from a mixed index.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>static void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/janusgraph/graphdb/database/util/StaleIndexRecordUtil.html#forceRemoveElementFromMixedIndex-java.lang.Object-java.util.Map-org.janusgraph.core.JanusGraph-java.lang.String-">forceRemoveElementFromMixedIndex</a></span>(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a>&nbsp;elementId,
                                <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Map.html?is-external=true" title="class or interface in java.util">Map</a>&lt;<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>,<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a>&gt;&nbsp;indexRecordPropertyValues,
                                <a href="../../../../../org/janusgraph/core/JanusGraph.html" title="interface in org.janusgraph.core">JanusGraph</a>&nbsp;graph,
                                <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;mixedIndexName)</code>
<div class="block">Force removes element record from a mixed index.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>static void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/janusgraph/graphdb/database/util/StaleIndexRecordUtil.html#forceRemoveVertexFromGraphIndex-long-java.util.Map-org.janusgraph.core.JanusGraph-java.lang.String-">forceRemoveVertexFromGraphIndex</a></span>(long&nbsp;vertexId,
                               <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Map.html?is-external=true" title="class or interface in java.util">Map</a>&lt;<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>,<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a>&gt;&nbsp;indexRecordPropertyValues,
                               <a href="../../../../../org/janusgraph/core/JanusGraph.html" title="interface in org.janusgraph.core">JanusGraph</a>&nbsp;graph,
                               <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;graphIndexName)</code>
<div class="block">Force removes vertex record from a graph index.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></h3>
<code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#clone--" title="class or interface in java.lang">clone</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#equals-java.lang.Object-" title="class or interface in java.lang">equals</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#finalize--" title="class or interface in java.lang">finalize</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#getClass--" title="class or interface in java.lang">getClass</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#hashCode--" title="class or interface in java.lang">hashCode</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#notify--" title="class or interface in java.lang">notify</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#notifyAll--" title="class or interface in java.lang">notifyAll</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#toString--" title="class or interface in java.lang">toString</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait--" title="class or interface in java.lang">wait</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait-long-" title="class or interface in java.lang">wait</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait-long-int-" title="class or interface in java.lang">wait</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="StaleIndexRecordUtil--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>StaleIndexRecordUtil</h4>
<pre>public&nbsp;StaleIndexRecordUtil()</pre>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="forceRemoveVertexFromGraphIndex-long-java.util.Map-org.janusgraph.core.JanusGraph-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>forceRemoveVertexFromGraphIndex</h4>
<pre>public static&nbsp;void&nbsp;forceRemoveVertexFromGraphIndex(long&nbsp;vertexId,
                                                   <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Map.html?is-external=true" title="class or interface in java.util">Map</a>&lt;<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>,<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a>&gt;&nbsp;indexRecordPropertyValues,
                                                   <a href="../../../../../org/janusgraph/core/JanusGraph.html" title="interface in org.janusgraph.core">JanusGraph</a>&nbsp;graph,
                                                   <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;graphIndexName)
                                            throws <a href="../../../../../org/janusgraph/diskstorage/BackendException.html" title="class in org.janusgraph.diskstorage">BackendException</a></pre>
<div class="block">Force removes vertex record from a graph index.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>vertexId</code> - the vertex which should be removed from a specified index</dd>
<dd><code>indexRecordPropertyValues</code> - all property values of the index record</dd>
<dd><code>graph</code> - JanusGraph instance to be used to open graph management and new backend transaction for index removal.</dd>
<dd><code>graphIndexName</code> - name of the graph index for which to remove a record</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../org/janusgraph/diskstorage/BackendException.html" title="class in org.janusgraph.diskstorage">BackendException</a></code> - is thrown in case backend transaction cannot be mutated for any reason.</dd>
</dl>
</li>
</ul>
<a name="forceRemoveElementFromGraphIndex-org.janusgraph.core.JanusGraphElement-org.janusgraph.graphdb.database.IndexRecordEntry:A-org.janusgraph.graphdb.database.StandardJanusGraph-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>forceRemoveElementFromGraphIndex</h4>
<pre>public static&nbsp;void&nbsp;forceRemoveElementFromGraphIndex(<a href="../../../../../org/janusgraph/core/JanusGraphElement.html" title="interface in org.janusgraph.core">JanusGraphElement</a>&nbsp;elementToRemoveFromIndex,
                                                    <a href="../../../../../org/janusgraph/graphdb/database/IndexRecordEntry.html" title="class in org.janusgraph.graphdb.database">IndexRecordEntry</a>[]&nbsp;indexRecord,
                                                    <a href="../../../../../org/janusgraph/graphdb/database/StandardJanusGraph.html" title="class in org.janusgraph.graphdb.database">StandardJanusGraph</a>&nbsp;graph,
                                                    <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;graphIndexName)
                                             throws <a href="../../../../../org/janusgraph/diskstorage/BackendException.html" title="class in org.janusgraph.diskstorage">BackendException</a></pre>
<div class="block">Force removes element record from a graph index.
 <p>
 An example of using this method is below:
 <pre>
 StandardJanusGraph graph = (StandardJanusGraph) JanusGraphFactory.open(configuration);
 StandardJanusGraphTx tx = (StandardJanusGraphTx) graph.newTransaction();
 JanusGraphManagement mgmt = graph.openManagement();
 // Let's say we want to remove non-existent vertex from a stale index.
 // We will assume the next constraints:
 // vertex id is 12345;
 // Composite index name is: nameIndex
 // There is a single indexed property: name
 // Value of the vertex property is: HelloWorld
 long vertexId = 12345L;
 String compositeIndexName = "nameIndex";
 String propertyKeyName = "name";
 String value = "HelloWorld";
 PropertyKey propertyKey = mgmt.getPropertyKey(propertyKeyName);
 long propertyKeyId = propertyKey.longId();
 IndexRecordEntry namePropertyIndexRecord = new IndexRecordEntry(propertyKeyId, value, propertyKey);
 IndexRecordEntry[] fullIndexRecord = new IndexRecordEntry[]{namePropertyIndexRecord};
 JanusGraphElement elementToBeRemoved = new CacheVertex(tx, vertexId, ElementLifeCycle.New);
 // After the below method is executed index entry of the vertex 12345 should be removed from the index which
 // effectively fixes permanent stale index inconsistency
 StaleIndexRecordUtil.forceRemoveElementFromGraphIndex(
     elementToBeRemoved,
     fullIndexRecord,
     graph,
     compositeIndexName
 );
 tx.commit();
 mgmt.rollback();
 </pre></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>elementToRemoveFromIndex</code> - an element which should be removed.</dd>
<dd><code>indexRecord</code> - an ordered array or index record properties which represent this index record.</dd>
<dd><code>graph</code> - JanusGraph instance to be used to open graph management and new backend transaction for index removal.</dd>
<dd><code>graphIndexName</code> - index name of the graph index for which to delete a specified indexRecord.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../org/janusgraph/diskstorage/BackendException.html" title="class in org.janusgraph.diskstorage">BackendException</a></code> - is thrown in case backend transaction cannot be mutated for any reason.</dd>
</dl>
</li>
</ul>
<a name="forceRemoveElementFromMixedIndex-java.lang.Object-java.util.Map-org.janusgraph.core.JanusGraph-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>forceRemoveElementFromMixedIndex</h4>
<pre>public static&nbsp;void&nbsp;forceRemoveElementFromMixedIndex(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a>&nbsp;elementId,
                                                    <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Map.html?is-external=true" title="class or interface in java.util">Map</a>&lt;<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>,<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a>&gt;&nbsp;indexRecordPropertyValues,
                                                    <a href="../../../../../org/janusgraph/core/JanusGraph.html" title="interface in org.janusgraph.core">JanusGraph</a>&nbsp;graph,
                                                    <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;mixedIndexName)
                                             throws <a href="../../../../../org/janusgraph/diskstorage/BackendException.html" title="class in org.janusgraph.diskstorage">BackendException</a></pre>
<div class="block">Force removes element record from a mixed index.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>elementId</code> - id of the element which should be removed from a specified index</dd>
<dd><code>indexRecordPropertyValues</code> - all property values of the index record</dd>
<dd><code>graph</code> - JanusGraph instance to be used to open graph management and new backend transaction for index removal.</dd>
<dd><code>mixedIndexName</code> - name of the mixed index for which to remove a record</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../org/janusgraph/diskstorage/BackendException.html" title="class in org.janusgraph.diskstorage">BackendException</a></code> - is thrown in case backend transaction cannot be mutated for any reason.</dd>
</dl>
</li>
</ul>
<a name="forceRemoveElementFromMixedIndex-java.lang.Object-org.janusgraph.graphdb.database.IndexRecordEntry:A-org.janusgraph.core.JanusGraph-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>forceRemoveElementFromMixedIndex</h4>
<pre>public static&nbsp;void&nbsp;forceRemoveElementFromMixedIndex(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a>&nbsp;elementId,
                                                    <a href="../../../../../org/janusgraph/graphdb/database/IndexRecordEntry.html" title="class in org.janusgraph.graphdb.database">IndexRecordEntry</a>[]&nbsp;indexRecord,
                                                    <a href="../../../../../org/janusgraph/core/JanusGraph.html" title="interface in org.janusgraph.core">JanusGraph</a>&nbsp;graph,
                                                    <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;mixedIndexName)
                                             throws <a href="../../../../../org/janusgraph/diskstorage/BackendException.html" title="class in org.janusgraph.diskstorage">BackendException</a></pre>
<div class="block">Force removes element record from a mixed index.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>elementId</code> - id of the element which should be removed from a specified index</dd>
<dd><code>indexRecord</code> - an unordered array or index record properties which represent this index record.</dd>
<dd><code>graph</code> - JanusGraph instance to be used to open graph management and new backend transaction for index removal.</dd>
<dd><code>mixedIndexName</code> - name of the mixed index for which to remove a record</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../org/janusgraph/diskstorage/BackendException.html" title="class in org.janusgraph.diskstorage">BackendException</a></code> - is thrown in case backend transaction cannot be mutated for any reason.</dd>
</dl>
</li>
</ul>
<a name="forceRemoveElementFromMixedIndex-java.lang.Object-org.janusgraph.core.JanusGraph-java.lang.String-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>forceRemoveElementFromMixedIndex</h4>
<pre>public static&nbsp;void&nbsp;forceRemoveElementFromMixedIndex(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a>&nbsp;elementId,
                                                    <a href="../../../../../org/janusgraph/core/JanusGraph.html" title="interface in org.janusgraph.core">JanusGraph</a>&nbsp;graph,
                                                    <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;mixedIndexName)
                                             throws <a href="../../../../../org/janusgraph/diskstorage/BackendException.html" title="class in org.janusgraph.diskstorage">BackendException</a></pre>
<div class="block">Force removes element fully from a mixed index.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>elementId</code> - id of the element which should be removed from a specified index</dd>
<dd><code>graph</code> - JanusGraph instance to be used to open graph management and new backend transaction for index removal.</dd>
<dd><code>mixedIndexName</code> - name of the mixed index for which to remove a record</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../org/janusgraph/diskstorage/BackendException.html" title="class in org.janusgraph.diskstorage">BackendException</a></code> - is thrown in case backend transaction cannot be mutated for any reason.</dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/StaleIndexRecordUtil.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../org/janusgraph/graphdb/database/util/IndexRecordUtil.html" title="class in org.janusgraph.graphdb.database.util"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li>Next&nbsp;Class</li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?org/janusgraph/graphdb/database/util/StaleIndexRecordUtil.html" target="_top">Frames</a></li>
<li><a href="StaleIndexRecordUtil.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Copyright &#169; 2012&#x2013;2022. All rights reserved.</small></p>
</body>
</html>
